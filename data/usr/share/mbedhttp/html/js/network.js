(()=>{var T=Object.defineProperty;var y=(a,s,e)=>s in a?T(a,s,{enumerable:!0,configurable:!0,writable:!0,value:e}):a[s]=e;var n=(a,s,e)=>(y(a,typeof s!="symbol"?s+"":s,e),e);var r=class{constructor(s){n(this,"_parent");this._parent=s}_onUpdate(){this.parent==null?this.render():this.parent._onUpdate}get parent(){return this._parent}set parent(s){this._parent=s}};var u=class extends r{constructor(e,t){super(t);n(this,"ip");n(this,"port");this.ip=document.createElement("input"),this.port=document.createElement("input"),this.ip.value=e.ip,this.port.value=e.port,this.ip.pattern="^([0-9]{1,3}.){3}[0-9]{1,3}$",this.port.pattern="^([0-9]).$"}update(e){this.ip.value=e.ip,this.port.value=e.port}value(){return{ip:this.ip.value,port:this.port.value}}render(){let e=document.createElement("div");var t=document.createElement("label"),i=document.createElement("label");t.innerText="Box IP:",i.innerText="port:";var o=[t,this.ip,i,this.port];for(var c of o)e.appendChild(c);return e}};var p=class extends r{constructor(e,t,i){super(i);n(this,"ip");n(this,"gateway");n(this,"mask");n(this,"title");this.title=e,this.ip=document.createElement("input"),this.gateway=document.createElement("input"),this.mask=document.createElement("input"),this.ip.pattern="^([0-9]{1,3}.){3}[0-9]{1,3}$",this.gateway.pattern="^([0-9]{1,3}.){3}[0-9]{1,3}$",this.mask.pattern="^([0-9]{1,3}.){3}[0-9]{1,3}$",this.ip.value=t.static_ip,this.gateway.value=t.gateway,this.mask.value=t.mask}update(e){this.ip.value=e.static_ip,this.gateway.value=e.gateway,this.mask.value=e.mask}value(){return{static_ip:this.ip.value,gateway:this.gateway.value,mask:this.mask.value}}render(){let e=document.createDocumentFragment(),t=document.createElement("label"),i=document.createElement("div"),o=document.createElement("label"),c=document.createElement("label"),w=document.createElement("label");t.innerText=this.title,o.innerText="Static IP:",c.innerText="Gateway:",w.innerText="Mask:",e.append(t);var b=[o,this.ip,c,this.gateway,w,this.mask];for(var E of b)i.appendChild(E);return e.append(i),e}};var h=class extends r{constructor(e,t){super(t);n(this,"ssid");n(this,"passwd");this.ssid=document.createElement("input"),this.passwd=document.createElement("input"),this.ssid.value=e.ssid,this.ssid.placeholder="SSID",this.passwd.value=e.passwd,this.passwd.placeholder="PASSWORD"}update(e){this.ssid.value=e.ssid,this.passwd.value=e.passwd}value(){return{ssid:this.ssid.value,passwd:this.passwd.value}}render(){let e=document.createElement("div"),t=document.createElement("label"),i=document.createElement("label");return t.innerText="SSID",i.innerText="Passwd",e.appendChild(t),e.appendChild(this.ssid),e.appendChild(i),e.appendChild(this.passwd),e}};var d=class extends r{constructor(e,t){super(t);n(this,"legend");this.legend=e}async save(){}render(){let e=document.createElement("fieldset");return e.innerHTML="<legend>".concat(this.legend,"</legend>"),e}},g=class extends d{constructor(e,t,i){super(e,i);n(this,"settings",[]);for(var o of t)this.settings.push(new h(o,this));this.reload()}async reload(){console.log("async reload wifi-settings"),fetch("/api/wpa_supplicant/info").then(e=>e.json()).then(e=>{console.log(e),e.metas.length>0&&e.metas.map((t,i)=>{i<e.max_info&&this.settings[i].update(t)})}).catch(e=>{console.log("exception: ",e)})}async save(){console.log("async save wifi-settings");var e=[];for(var t of this.settings)e.push(t.value());var i=new XMLHttpRequest;i.open("POST","/api/wpa_supplicant/info",!0),i.setRequestHeader("Content-Type","application/json"),i.send(JSON.stringify({metas:e}))}render(){let e=super.render();for(let t of this.settings)e.appendChild(t.render());return e}},f=class extends d{constructor(e,t){super(e,t);n(this,"settings",[]);this.settings.push(new p("eth",{static_ip:"",gateway:"",mask:""},this),new p("wlan",{static_ip:"",gateway:"",mask:""},this)),this.reload()}async reload(){fetch("/api/dhcpcd/eth").then(e=>e.json()).then(e=>{console.log(e),this.settings[0].update(e)}).catch(e=>{console.log("exception: ",e)}),fetch("/api/dhcpcd/wlan").then(e=>e.json()).then(e=>{console.log(e),this.settings[1].update(e)}).catch(e=>{console.log("exception: ",e)})}async save(){console.log("async save ip-settings");var e=new XMLHttpRequest;e.open("POST","/api/dhcpcd/eth",!0),e.setRequestHeader("Content-Type","application/json"),e.send(JSON.stringify(this.settings[0].value())),e=new XMLHttpRequest,e.open("POST","/api/dhcpcd/wlan",!0),e.setRequestHeader("Content-Type","application/json"),e.send(JSON.stringify(this.settings[1].value()))}render(){let e=super.render();var t=document.createElement("div");t.style.display="grid",t.style["grid-template-columns"]="auto 1fr",t.style["column-gap"]="10px",t.id="ip-settings";for(var i of this.settings)t.appendChild(i.render());return e.appendChild(t),e}},v=class extends d{constructor(e,t){super(e,t);n(this,"client");this.client=new u({ip:"",port:""},this),this.reload()}async reload(){fetch("/api/box/info").then(e=>e.json()).then(e=>{console.log(e),this.client.update(e)}).catch(e=>{console.log("exception: ",e)})}async save(){console.log("async save app-settings");var e=new XMLHttpRequest;e.open("POST","/api/box/info",!0),e.setRequestHeader("Content-Type","application/json"),e.send(JSON.stringify(this.client.value()))}render(){let e=super.render();return e.appendChild(this.client.render()),e}},l={WIFI_SETTING:0,IP_SETTING:1,APP_SETTING:2},m=class extends r{constructor(e){super(e);n(this,"fieldsets",{});n(this,"button");this.fieldsets[l.WIFI_SETTING]=new g("WiFi Settings",[{ssid:"",passwd:""},{ssid:"",passwd:""},{ssid:"",passwd:""}],this),this.fieldsets[l.IP_SETTING]=new f("IP Settings",this),this.fieldsets[l.APP_SETTING]=new v("APP Settings",this),this.button=document.createElement("button"),this.button.className="primary",this.button.id="savebtn",this.button.type="button",this.button.innerText="SAVE",this.button.onclick=()=>{this.on_save()}}render(){let e=document.createElement("form");console.log(this.fieldsets);for(var t in l)e.appendChild(this.fieldsets[l[t]].render());return e.appendChild(this.button),e}on_save(){console.log("button was clicked!");for(var e in l)this.fieldsets[l[e]].save()}};var _=new m;window.addEventListener("load",a=>{console.log("on windows load.");let s=document.getElementById("app");s==null||s.append(_.render())});})();
//# sourceMappingURL=network.js.map
